设想你是一个四维人，你的眼睛看到的图像是三维的，因为除了上下左右，还多出了两个方向。
由于可怜的三维生物（我们）只有二维视觉，所以只好把四维人眼中的三维视野图像做成半透明的给三维生物们观看，这就是4DViewer项目。但三维视野图像感觉上就是看一团雾，我们可以选择一些截面去截这个视野。比如我们可以抽取过三维图像中心的x、y、z三个方向的截面，单独放到三个角落上一边观察。

## 初探四维

### 简单的例子：超立方体 [examples/hypercube.html](https://wxyhly.github.io/4dViewer/examples/hypercube.html)

使用鼠标左右键均可拖动改变观察角度，滚动鼠标滚轮将拉近/推远相机位置。你现在处于超立方体内部。试着推远相机，你将钻出来从外面看到整个立方体。
超立方体由8个全等的正方体胞（“胞”指三维面，下同）围成。为区分方便，每个正方体胞心上还画了不同颜色的球形图案。


### 正多胞体以及其它基本几何体 [examples/polychora.html](https://wxyhly.github.io/4dViewer/examples/polychora.html)

在右侧的控制栏中选择形状栏下拉菜单中可选择正多胞体、柱体、锥体、旋转体、直积形等等大量四维图形。对于比较复杂的几何体（如超球）会有一点卡顿的现象，此时建议将显示模式改为仅显示胞，然后按键盘`C`显示边。

### 四维样条线及放样 [examples/spline.html](https://wxyhly.github.io/4dViewer/examples/spline.html)

摄影机被固定在截胞为圆柱体的弯曲隧道中心线上前行。可通过调整右侧面板上的speed值通知前进或后退的速度。

## 四维入门

在见识了一些基本形状之后，我们来体会一下*第一人称视角*。
- **操作说明：**使用`W` `S` `A` `D`前后左右平移，新的四维方向（对应三维立方体视野图像的前后）使用`Q` `E`平移，它本质上是一种新的“侧面”方向，因为它不是重力方向（上下）也不是你面对的方向（前后），本文暂且叫它们**侧前**、**侧后**；按住空格键升高，松开后会在重力作用下掉回地面。鼠标上下左右移动或`U` `O` `J` `L`可以环视六周（注意四维有六“周”而不是四周），分别对应向侧前、侧后、左、右环视转向。最后鼠标滚轮或IK键控制抬头或俯视；按`Z` `X`可旋转三维视野图像，按`C`可以显示边（其实画的是每张截面的顶点），以便在模糊的透明图像中看清物体的轮廓。按H可隐藏右边的控制栏。

**一些例子：**

### Slope [examples/slope.html](https://wxyhly.github.io/4dViewer/examples/slope.html)
包含斜坡、平台和一个隧道的简单场景。
- 目标：找好合适的角度走上斜坡，通过平台穿过隧道来到另一头。

### 游戏Tetraspace：[examples/tetraspace.html](https://wxyhly.github.io/4dViewer/examples/tetraspace.html)
（这是一个[免费的四维截面游戏](https://rantonels.itch.io/brane)，这个例子照搬了里面的前11个关卡，在这里向作者致敬）
+ 初级目标：在不使用空格键跳跃的情况下找到空中悬浮的白色小超立方体，触碰通关。注：蓝色超立方体方块可以面朝着把它推动，绿色的超立方体是激光器，不能碰到它以及它发出的激光束。
+ 高级目标：在只有三维视野（可按键盘`C`开启线框模式）不看三个截面缩略图的情况下通关。

## 场景更复杂的例子

（注：这些例子包含图形面数较多，可能导致浏览器较卡顿）
### 四维地形 [examples/terrain.html](https://wxyhly.github.io/4dViewer/examples/terrain.html)

采用3D Perlin噪声作为高度图生成的四维地形。

### 四维Minecraft [examples/minecraft4.html](https://wxyhly.github.io/4dViewer/examples/minecraft4.html)

基于随机种子的无限世界，使用鼠标左键破坏、右键放置！如果太卡可以调小renderDistance（渲染区块距离）参数。目前生物群系只有被森林覆盖的平原和小丘陵。
###  四维分形海绵：
***（警告：非常卡） ***
您将看到三种四维分形，它们是从一维Cantor点集、二维谢尔宾斯基地毯、到三维门格-谢尔宾斯基雪花（3D Cantor 尘埃）、门格海绵两种类比，最后类比到四维的、真正四维人喜欢的分形。当然，出于复杂度考虑，这些分形只迭代了3次。
提示：如果画面特别卡顿，可以按`-`键减少截面的渲染层数。

## 进阶操作
### 相机设置
- ***Fov***  调整相机视野，也可通过按大键盘`9` `0`实现。

### 渲染设置
4DViewer中，三维视野其实是通过Webgl渲染很多二维的视野截面叠在一起的。展开右侧面板Renderer项可以看到渲染器的很多设置：
- ***Thickness***  可调整截面间距（设小后三维视野质量更高，但会导致卡顿），也可通过按大键盘`+` `-`实现。
- ***Flow***  调整图像不透明度。建议其值保持适中，过大将导致只有视野表面才可见，也可通过按键盘`[` `]`实现。
- ***ThumbSize***  调整屏幕三角的截面缩略图大小，也可通过按键盘`;` `'`实现。
- ***WireFrameMode***  即通过显示每个截面截得物体顶点得到的线框模式，也可通过按键盘`C`实现切换。
- ***bgColor4***  为四维世界中的背景颜色（如天空颜色）
- ***bgColor3***  为将3D视野投影到2D的屏幕背景颜色。可以通过按键盘`,` `.`在黑-灰-白的范围内调整。
- ***Transparency***  当3D视野中物体复杂时往往太模糊，不便于观察，有时我们希望某些像素变得透明以便观察。按住`Alt+1` `Alt+2` `Alt+3` `Alt+4` 并点击鼠标右键可以存储4种希望透明处理的颜色，只按住Alt键点击将清除所有透明色设置。

### 太阳控制

关于四维行星、太阳系统请参考[这篇文章](https://wxyhly.github.io/2018/08/12/orbit4d/)。下面仅介绍展开面板中Sun下的参数设置：
- ***NS*** 设置当地的纬度值，范围0-90；
- ***SouthernTime*** 与 ***NorthernTime*** 分别对应南北方两种计时系统的时刻，它们反映的是当地的两个经度值。
- ***Season*** 为公转轨道的角度值；
- ***SouthernTropic*** 和 ***NorthernTropic***为一年中太阳最南、最北直射纬度值，即两个黄赤交角。
- ***MGPeriode*** 与*** WEPeriode*** 分别对应南北极自转一周的小时数。
- 后面的***SunAngle***（太阳高度角）和 ***SunNS***（太阳直射纬度）为只读量。
- ***TimeStep*** 可以调节时间流逝速度。

## 灵感来源（感谢）
- [4DToys](http://4dtoys.com/)
- [4DBlock](http://www.urticator.net/blocks/)
- [Tetraspace](https://rantonels.itch.io/brane)

## 后续计划

简单四维刚体物理引擎（太难了，可能会无限搁置了。。）